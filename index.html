<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    
    <meta charset="UTF-8">
    <meta name="google-adsense-account" content="ca-pub-5505800579942052">
    <title>ProTools | Professional Suite</title>
   

    <!-- Professional Font: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* --- 1. MODERN CSS VARIABLES --- */
        :root {
            --bg-app: #f3f4f6;
            --bg-sidebar: #ffffff;
            --bg-card: #ffffff;
            --text-main: #111827;
            --text-muted: #6b7280;
            --primary: #3b82f6;
            --primary-glow: rgba(59, 130, 246, 0.4);
            --border: #e5e7eb;
            --input-bg: #f9fafb;
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --danger: #ef4444;
            --radius: 12px;
        }

        [data-theme="dark"] {
            --bg-app: #0f172a;
            --bg-sidebar: #1e293b;
            --bg-card: #1e293b;
            --text-main: #f9fafb;
            --text-muted: #94a3b8;
            --primary: #60a5fa;
            --primary-glow: rgba(96, 165, 250, 0.3);
            --border: #334155;
            --input-bg: #0f172a;
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
            --shadow-sm: none;
        }

        /* --- 2. GLOBAL RESET --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background-color: var(--bg-app);
            color: var(--text-main);
            margin: 0;
            height: 100vh;
            display: flex;
            overflow: hidden;
            transition: background 0.3s ease, color 0.3s ease;
        }

        /* --- 3. SIDEBAR NAVIGATION --- */
        aside {
            width: 280px;
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            padding: 24px;
            z-index: 50;
            transition: all 0.3s ease;
        }

        .brand {
            font-size: 1.25rem;
            font-weight: 800;
            color: var(--text-main);
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 40px;
            letter-spacing: -0.5px;
        }
        .brand span { color: var(--primary); }

        nav { flex: 1; display: flex; flex-direction: column; gap: 8px; }

        .nav-btn {
            background: transparent;
            border: none;
            color: var(--text-muted);
            padding: 12px 16px;
            border-radius: var(--radius);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s;
        }

        .nav-btn:hover { background: var(--bg-app); color: var(--text-main); }
        .nav-btn.active { background: var(--primary); color: #fff; box-shadow: 0 4px 12px var(--primary-glow); }
        .nav-btn svg { width: 20px; height: 20px; }

        .user-profile {
            margin-top: auto;
            border-top: 1px solid var(--border);
            padding-top: 20px;
        }
        .theme-toggle {
            background: var(--input-bg);
            border: 1px solid var(--border);
            color: var(--text-main);
            width: 100%;
            padding: 10px;
            border-radius: var(--radius);
            cursor: pointer;
            font-size: 0.9rem;
            display: flex; justify-content: center; align-items: center; gap: 8px;
            font-weight: 500;
        }
        .theme-toggle:hover { border-color: var(--text-muted); }

        /* --- 4. MAIN CONTENT AREA --- */
        main {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
            position: relative;
        }

        .panel { 
            display: none; 
            max-width: 900px; 
            margin: 0 auto; 
            animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .panel.active { display: block; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page-header { margin-bottom: 30px; }
        .page-header h1 { font-size: 1.8rem; font-weight: 700; margin: 0; letter-spacing: -0.5px; }
        .page-header p { color: var(--text-muted); margin: 5px 0 0 0; }

        /* --- 5. UI COMPONENTS --- */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 24px;
            box-shadow: var(--shadow-md);
            margin-bottom: 24px;
        }

        label { display: block; font-size: 0.85rem; font-weight: 600; color: var(--text-muted); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
        
        input, select, textarea {
            width: 100%;
            padding: 14px;
            background: var(--input-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            color: var(--text-main);
            font-size: 1rem;
            font-family: inherit;
            transition: border 0.2s;
        }
        input:focus, select:focus, textarea:focus { border-color: var(--primary); box-shadow: 0 0 0 4px var(--primary-glow); }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
            transition: transform 0.1s, opacity 0.2s;
        }
        .btn:hover { opacity: 0.9; }
        .btn:active { transform: scale(0.98); }
        .btn-outline { background: transparent; border: 1px solid var(--border); color: var(--text-muted); width: auto; padding: 8px 12px; border-radius: 8px; font-size: 0.9rem; cursor: pointer; }
        .btn-outline:hover { color: var(--danger); border-color: var(--danger); }

        /* --- 6. TOOL STYLES --- */
        /* Dashboard */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: var(--bg-card); padding: 20px; border-radius: var(--radius); border: 1px solid var(--border); box-shadow: var(--shadow-sm); display: flex; flex-direction: column; }
        .stat-value { font-size: 2rem; font-weight: 800; color: var(--text-main); }
        .stat-label { font-size: 0.9rem; color: var(--text-muted); }

        /* Calculator */
        .calc-wrapper { max-width: 360px; margin: 0 auto; }
        .calc-screen { text-align: right; font-size: 2.5rem; border: none; background: transparent; margin-bottom: 20px; font-family: 'Inter', monospace; letter-spacing: -1px; }
        .calc-keys { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        .key {
            padding: 18px; font-size: 1.25rem; border-radius: 16px; border: 1px solid var(--border); background: var(--bg-app); color: var(--text-main); cursor: pointer; transition: 0.1s;
        }
        .key:hover { background: var(--border); }
        .key.accent { background: var(--primary); color: white; border: none; }
        .key.clear { color: var(--danger); background: rgba(239, 68, 68, 0.1); border-color: transparent; }

        /* Password */
        .password-display {
            background: var(--bg-app); border: 2px dashed var(--border); border-radius: var(--radius);
            padding: 24px; text-align: center; font-family: monospace; font-size: 1.4rem; color: var(--primary);
            cursor: pointer; margin: 20px 0; word-break: break-all; transition: 0.2s;
        }
        .password-display:hover { background: var(--input-bg); border-color: var(--primary); }
        
        .toggle-group { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 20px; }
        .toggle-btn {
            background: var(--input-bg); border: 1px solid var(--border); padding: 12px; border-radius: 8px;
            cursor: pointer; display: flex; align-items: center; gap: 10px; font-size: 0.9rem; font-weight: 500;
        }
        .toggle-btn.checked { border-color: var(--primary); background: rgba(59, 130, 246, 0.05); color: var(--primary); }
        .toggle-btn input { display: none; }

        /* Vault */
        .vault-list { display: flex; flex-direction: column; gap: 12px; }
        .vault-item {
            display: flex; justify-content: space-between; align-items: center; padding: 16px;
            background: var(--input-bg); border-radius: var(--radius); border: 1px solid var(--border);
        }

        /* --- 7. TOAST --- */
        .toast {
            position: fixed; bottom: 24px; right: 24px; background: var(--text-main); color: var(--bg-card);
            padding: 12px 24px; border-radius: 8px; font-weight: 600; font-size: 0.9rem;
            transform: translateY(100px); opacity: 0; transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 100; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.3);
        }
        .toast.visible { transform: translateY(0); opacity: 1; }

        /* --- 8. MOBILE RESPONSIVE --- */
        @media (max-width: 768px) {
            body { flex-direction: column; height: 100vh; }
            aside {
                position: fixed; bottom: 0; left: 0; width: 100%; height: 70px;
                border-right: none; border-top: 1px solid var(--border);
                flex-direction: row; padding: 8px; justify-content: space-around;
                background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px);
            }
            [data-theme="dark"] aside { background: rgba(30, 41, 59, 0.9); }

            .brand, .user-profile { display: none; }
            nav { flex-direction: row; width: 100%; justify-content: space-around; }
            
            .nav-btn { flex-direction: column; gap: 4px; padding: 8px; font-size: 0.7rem; border-radius: 8px; justify-content: center; }
            .nav-btn svg { width: 24px; height: 24px; }
            .nav-btn.active { background: transparent; color: var(--primary); box-shadow: none; }
            
            main { padding: 20px; padding-bottom: 90px; }
            .page-header h1 { font-size: 1.5rem; }
            
            .mobile-fab {
                position: fixed; top: 16px; right: 16px; width: 40px; height: 40px;
                background: var(--bg-card); border: 1px solid var(--border); border-radius: 50%;
                display: flex; align-items: center; justify-content: center; z-index: 60;
                box-shadow: var(--shadow-md); cursor: pointer; color: var(--text-main);
            }
        }
        @media (min-width: 769px) { .mobile-fab { display: none; } }
    </style>
</head>
<body>

    <!-- Toast Notification -->
    <div id="toast" class="toast">Action Successful</div>

    <!-- Mobile Theme Toggle -->
    <button class="mobile-fab" onclick="toggleTheme()">
        <span id="theme-icon-mobile">ðŸŒ™</span>
    </button>

    <!-- Sidebar -->
    <aside>
        <div class="brand">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path></svg>
            <span>ProTools</span>
        </div>
        <nav>
            <button class="nav-btn active" onclick="nav('dashboard', this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
                Dashboard
            </button>
            <button class="nav-btn" onclick="nav('calc', this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="2" width="16" height="20" rx="2"/><line x1="8" y1="6" x2="16" y2="6"/><line x1="16" y1="14" x2="16" y2="14"/><line x1="12" y1="14" x2="12" y2="14"/><line x1="8" y1="14" x2="8" y2="14"/><line x1="16" y1="18" x2="16" y2="18"/><line x1="12" y1="18" x2="12" y2="18"/><line x1="8" y1="18" x2="8" y2="18"/></svg>
                Calculator
            </button>
            <button class="nav-btn" onclick="nav('pass', this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                Generator
            </button>
            <button class="nav-btn" onclick="nav('vault', this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                Vault
            </button>
            <button class="nav-btn" onclick="nav('conv', this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"/></svg>
                Converter
            </button>
        </nav>
        <div class="user-profile">
            <button class="theme-toggle" onclick="toggleTheme()">
                <span id="theme-icon-desk">ðŸŒ™</span> <span id="theme-text">Dark Mode</span>
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main>
        
        <!-- DASHBOARD -->
        <div id="dashboard" class="panel active">
            <div class="page-header">
                <h1>Welcome Back</h1>
                <p>Here is an overview of your tools.</p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-value" id="dash-pass-count">0</span>
                    <span class="stat-label">Saved Passwords</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="dash-calc-last">0</span>
                    <span class="stat-label">Last Calculation</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="dash-date">--</span>
                    <span class="stat-label">Current Date</span>
                </div>
            </div>

            <div class="card">
                <h3>Quick Tips</h3>
                <ul style="color:var(--text-muted); padding-left:20px; line-height:1.6;">
                    <li>Use the <strong>Generator</strong> to create strong passwords.</li>
                    <li>Passwords saved in the <strong>Vault</strong> are stored locally on your device.</li>
                    <li>The <strong>Calculator</strong> supports keyboard input on desktop.</li>
                </ul>
            </div>
        </div>

        <!-- CALCULATOR -->
        <div id="calc" class="panel">
            <div class="page-header"><h1>Calculator</h1></div>
            <div class="calc-wrapper">
                <input type="text" id="calc-disp" class="calc-screen" readonly value="0">
                <div class="calc-keys">
                    <button class="key clear" onclick="calcInput('C')">AC</button>
                    <button class="key" onclick="calcInput('DEL')">âŒ«</button>
                    <button class="key" onclick="calcInput('%')">%</button>
                    <button class="key accent" onclick="calcInput('/')">Ã·</button>
                    
                    <button class="key" onclick="calcInput('7')">7</button>
                    <button class="key" onclick="calcInput('8')">8</button>
                    <button class="key" onclick="calcInput('9')">9</button>
                    <button class="key accent" onclick="calcInput('*')">Ã—</button>
                    
                    <button class="key" onclick="calcInput('4')">4</button>
                    <button class="key" onclick="calcInput('5')">5</button>
                    <button class="key" onclick="calcInput('6')">6</button>
                    <button class="key accent" onclick="calcInput('-')">-</button>
                    
                    <button class="key" onclick="calcInput('1')">1</button>
                    <button class="key" onclick="calcInput('2')">2</button>
                    <button class="key" onclick="calcInput('3')">3</button>
                    <button class="key accent" onclick="calcInput('+')">+</button>
                    
                    <button class="key" style="grid-column: span 2" onclick="calcInput('0')">0</button>
                    <button class="key" onclick="calcInput('.')">.</button>
                    <button class="key accent" onclick="calcInput('=')">=</button>
                </div>
            </div>
        </div>

        <!-- PASSWORD GENERATOR -->
        <div id="pass" class="panel">
            <div class="page-header"><h1>Generator</h1><p>Create secure, random passwords.</p></div>
            <div class="card">
                <label>Length: <span id="len-val" style="color:var(--primary)">16</span></label>
                <input type="range" id="p-len" min="6" max="64" value="16" oninput="generatePass()">
                
                <div class="toggle-group">
                    <label class="toggle-btn checked" onclick="toggleCheck(this); generatePass()">
                        <input type="checkbox" id="p-abc" checked> Lowercase (abc)
                    </label>
                    <label class="toggle-btn checked" onclick="toggleCheck(this); generatePass()">
                        <input type="checkbox" id="p-ABC" checked> Uppercase (ABC)
                    </label>
                    <label class="toggle-btn checked" onclick="toggleCheck(this); generatePass()">
                        <input type="checkbox" id="p-123" checked> Numbers (123)
                    </label>
                    <label class="toggle-btn checked" onclick="toggleCheck(this); generatePass()">
                        <input type="checkbox" id="p-sym" checked> Symbols (!@#)
                    </label>
                </div>

                <div class="password-display" id="p-result" onclick="copyText(this.innerText)">Loading...</div>
                <button class="btn" onclick="generatePass()">Regenerate</button>

                <div style="margin-top:30px; padding-top:20px; border-top:1px solid var(--border);">
                    <label>Save to Vault</label>
                    <div style="display:flex; gap:10px; flex-wrap:wrap;">
                        <input type="text" id="save-title" placeholder="Website Name (e.g. Netflix)" style="flex:1;">
                        <input type="text" id="save-user" placeholder="User/Email" style="flex:1;">
                        <button class="btn" style="width:auto;" onclick="savePass()">Save</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- VAULT -->
        <div id="vault" class="panel">
            <div class="page-header"><h1>Password Vault</h1><p>Securely stored in browser local storage.</p></div>
            <div class="card">
                <input type="text" id="vault-search" placeholder="Search passwords..." oninput="renderVault()">
                <div id="vault-list" class="vault-list" style="margin-top:20px;"></div>
                <div id="vault-empty" style="text-align:center; padding:40px; color:var(--text-muted);">Vault is empty.</div>
            </div>
        </div>

        <!-- CONVERTER -->
        <div id="conv" class="panel">
            <div class="page-header"><h1>Unit Converter</h1></div>
            <div class="card">
                <label>Convert</label>
                <select id="c-type" onchange="updateConv()">
                    <option value="len">Length (Meters â†” Feet)</option>
                    <option value="wgt">Weight (Kilograms â†” Pounds)</option>
                    <option value="tmp">Temp (Celsius â†” Fahrenheit)</option>
                </select>
                
                <div style="display:flex; gap:16px; margin-top:20px; align-items:center;">
                    <div style="flex:1;">
                        <label id="lbl-from">Meters</label>
                        <input type="number" id="inp-from" oninput="convert()">
                    </div>
                    <div style="font-size:1.5rem; color:var(--text-muted); padding-top:20px;">=</div>
                    <div style="flex:1;">
                        <label id="lbl-to">Feet</label>
                        <input type="number" id="inp-to" readonly style="background: var(--bg-app)">
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script>
        /* --- 1. CORE & THEME --- */
        const html = document.documentElement;
        
        function toggleTheme() {
            const current = html.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', next);
            localStorage.setItem('pt_theme', next);
            
            // Update icons
            const icon = next === 'dark' ? 'ðŸŒ™' : 'â˜€ï¸';
            const text = next === 'dark' ? 'Dark Mode' : 'Light Mode';
            document.getElementById('theme-icon-desk').innerText = icon;
            document.getElementById('theme-text').innerText = text;
            document.getElementById('theme-icon-mobile').innerText = icon;
        }

        // Init Theme
        const savedTheme = localStorage.getItem('pt_theme') || 'dark';
        html.setAttribute('data-theme', savedTheme);
        if(savedTheme === 'light') {
            document.getElementById('theme-icon-desk').innerText = 'â˜€ï¸';
            document.getElementById('theme-text').innerText = 'Light Mode';
            document.getElementById('theme-icon-mobile').innerText = 'â˜€ï¸';
        }

        /* --- 2. ROBUST COPY FUNCTION (THE FIX) --- */
        function copyText(text) {
            if(!text || text === "Select Option" || text === "Loading...") return;

            // Method 1: Modern API (Works on HTTPS and localhost)
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(text).then(() => {
                    showToast("Copied to Clipboard!");
                }).catch(() => {
                    fallbackCopy(text);
                });
            } else {
                // Method 2: Fallback (Works on file:// and older browsers)
                fallbackCopy(text);
            }
        }

        function fallbackCopy(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            
            // Ensure textArea is not visible but part of the DOM
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";
            textArea.style.opacity = "0";

            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            try {
                const successful = document.execCommand('copy');
                if(successful) showToast("Copied to Clipboard!");
                else showToast("Copy failed.");
            } catch (err) {
                showToast("Copy failed.");
            }

            document.body.removeChild(textArea);
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.classList.add('visible');
            setTimeout(() => t.classList.remove('visible'), 2500);
        }

        /* --- 3. NAVIGATION --- */
        function nav(id, btn) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');
            
            if(id === 'dashboard') updateDashboard();
        }

        function updateDashboard() {
            try {
                const vault = JSON.parse(localStorage.getItem('pt_vault')) || [];
                document.getElementById('dash-pass-count').innerText = vault.length;
                document.getElementById('dash-date').innerText = new Date().toLocaleDateString();
            } catch(e) { console.log(e); }
        }

        /* --- 4. CALCULATOR --- */
        let cStr = "0";
        let reset = false;

        function calcInput(key) {
            const disp = document.getElementById('calc-disp');
            
            if(key === 'C') { cStr = "0"; reset = false; }
            else if(key === 'DEL') {
                if(cStr === "Error") cStr = "0";
                else cStr = cStr.length > 1 ? cStr.slice(0,-1) : "0";
            }
            else if(key === '=') {
                try {
                    const result = new Function('return ' + cStr)();
                    cStr = parseFloat(result.toFixed(8)).toString();
                    document.getElementById('dash-calc-last').innerText = cStr;
                    reset = true;
                } catch { cStr = "Error"; reset = true; }
            }
            else {
                if(reset && !['+','-','*','/','%'].includes(key)) { cStr = key; reset = false; }
                else if(reset) { reset = false; cStr += key; }
                else {
                    if(cStr === "0" && key !== '.') cStr = key;
                    else cStr += key;
                }
            }
            disp.value = cStr;
        }

        /* --- 5. PASSWORD GEN --- */
        function toggleCheck(el) {
            const box = el.querySelector('input');
            box.checked = !box.checked;
            if(box.checked) el.classList.add('checked');
            else el.classList.remove('checked');
        }

        function generatePass() {
            const len = document.getElementById('p-len').value;
            document.getElementById('len-val').innerText = len;
            
            const useAbc = document.getElementById('p-abc').checked;
            const useABC = document.getElementById('p-ABC').checked;
            const use123 = document.getElementById('p-123').checked;
            const useSym = document.getElementById('p-sym').checked;

            let chars = "";
            if(useAbc) chars += "abcdefghijklmnopqrstuvwxyz";
            if(useABC) chars += "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            if(use123) chars += "0123456789";
            if(useSym) chars += "!@#$%^&*()_+~`|}{[]:;?><,./-=";

            if(!chars) { document.getElementById('p-result').innerText = "Select Option"; return; }

            let pass = "";
            const arr = new Uint32Array(len);
            window.crypto.getRandomValues(arr);
            for(let i=0; i<len; i++) pass += chars[arr[i] % chars.length];
            document.getElementById('p-result').innerText = pass;
        }

        /* --- 6. VAULT --- */
        function escapeHTML(str) {
            return str.replace(/[&<>'"]/g, tag => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', "'": '&#39;', '"': '&quot;' }[tag]));
        }

        function getVault() { return JSON.parse(localStorage.getItem('pt_vault')) || []; }

        function savePass() {
            const pass = document.getElementById('p-result').innerText;
            const title = document.getElementById('save-title').value.trim();
            const user = document.getElementById('save-user').value.trim();

            if(pass === "Select Option" || !title) { showToast("Generate pass & enter title"); return; }

            const vault = getVault();
            vault.push({ id: Date.now(), title, user, pass });
            localStorage.setItem('pt_vault', JSON.stringify(vault));
            
            showToast("Saved to Vault");
            document.getElementById('save-title').value = "";
            renderVault();
            updateDashboard();
        }

        function renderVault() {
            const list = document.getElementById('vault-list');
            const term = document.getElementById('vault-search').value.toLowerCase();
            const vault = getVault();
            
            list.innerHTML = "";
            const filtered = vault.filter(v => v.title.toLowerCase().includes(term));

            if(filtered.length === 0) document.getElementById('vault-empty').style.display = 'block';
            else {
                document.getElementById('vault-empty').style.display = 'none';
                filtered.forEach(v => {
                    // Note: copyText() is now used instead of navigator.clipboard
                    list.innerHTML += `
                    <div class="vault-item">
                        <div>
                            <strong style="font-size:1.05rem">${escapeHTML(v.title)}</strong>
                            <div style="font-size:0.85rem; color:var(--text-muted)">${escapeHTML(v.user)}</div>
                        </div>
                        <div style="display:flex; gap:8px;">
                            <button class="btn-outline" onclick="copyText('${v.pass}')">Copy</button>
                            <button class="btn-outline" style="color:var(--danger); border-color:var(--border)" onclick="delPass(${v.id})">âœ•</button>
                        </div>
                    </div>`;
                });
            }
        }

        function delPass(id) {
            if(confirm("Delete this password?")) {
                const vault = getVault().filter(v => v.id !== id);
                localStorage.setItem('pt_vault', JSON.stringify(vault));
                renderVault();
                updateDashboard();
            }
        }

        /* --- 7. CONVERTER --- */
        const convData = { 
            len: {f:'Meters', t:'Feet', r:3.28084},
            wgt: {f:'Kilograms', t:'Pounds', r:2.20462},
            tmp: {f:'Celsius', t:'Fahrenheit'}
        };

        function updateConv() {
            const type = document.getElementById('c-type').value;
            document.getElementById('lbl-from').innerText = convData[type].f;
            document.getElementById('lbl-to').innerText = convData[type].t;
            convert();
        }

        function convert() {
            const val = parseFloat(document.getElementById('inp-from').value);
            const type = document.getElementById('c-type').value;
            const out = document.getElementById('inp-to');
            
            if(isNaN(val)) { out.value = ""; return; }

            if(type === 'tmp') out.value = ((val * 9/5) + 32).toFixed(2);
            else out.value = (val * convData[type].r).toFixed(2);
        }

        // Init
        window.onload = () => {
            generatePass();
            renderVault();
            updateDashboard();
        }
    </script>
</body>

</html>
